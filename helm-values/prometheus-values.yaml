---
# --- Prometheus Operator Settings ---
prometheusOperator:
  # Enables the operator, which manages Prometheus and Alertmanager configurations.
  enabled: true
  # Disables internal TLS for simpler local setup.
  tls:
    enabled: false
  # Disables webhooks, fixing errors in local 'kind' environments.
  admissionWebhooks:
    enabled: false
    patch:
      enabled: false
    certManager:
      enabled: false

# --- Alertmanager Settings ---
alertmanager:
  alertmanagerSpec:
    # Uses temporary storage, as data will be ephemeral for local development.
    storage:
      emptyDir: {}

# --- Prometheus Server Settings ---
prometheus:
  prometheusSpec:
    # Uses temporary storage for all metric data.
    storageSpec:
      emptyDir: {}
    # Enables the receiver for Remote Write, allowing the OTel Collector to push metrics.
    enableRemoteWriteReceiver: true

    # Exposes the Prometheus UI service.
    service:
      # Makes the service reachable via NodePort mapping in kind-config.yaml.
      type: NodePort
      # Internal cluster port.
      port: 9090
      # Static port on the node exposed to the host machine.
      nodePort: 30090

    # Disables the optional component for long-term storage/querying.
    thanosRuler:
      enabled: false

# --- Grafana Settings ---
grafana:
  # Disables persistent storage for dashboard definitions.
  persistence:
    enabled: false

  # Exposes the Grafana UI service.
  service:
    type: NodePort
    port: 3000
    nodePort: 30000

  # Sets the default admin password.
  # HACK: Hardcoded for local use; this should be a Kubernetes Secret in production.
  adminPassword: "admin"

  # Declaratively creates data sources that load automatically on startup.
  additionalDataSources:
    # --- LOKI DATA SOURCE ---
    - name: Loki
      type: loki
      # Targets the main Loki service endpoint.
      url: http://loki.logging.svc.cluster.local:3100
      access: proxy
      isDefault: false

    # --- TEMPO DATA SOURCE ---
    - name: Tempo
      type: tempo
      # Targets the main Tempo service endpoint.
      url: http://tempo.tracing.svc.cluster.local:3100
      access: proxy
      isDefault: false
